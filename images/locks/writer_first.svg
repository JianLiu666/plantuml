<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="628px" preserveAspectRatio="none" style="width:885px;height:628px;background:#EFF1F3;" version="1.1" viewBox="0 0 885 628" width="885px" zoomAndPan="magnify"><defs/><g><rect fill="#FCD766" height="302.7949" style="stroke: #777777; stroke-width: 1.0;" width="10" x="119" y="65.7988"/><rect fill="#FCD766" height="302.7949" style="stroke: #777777; stroke-width: 1.0;" width="10" x="359" y="166.7305"/><rect fill="#F19B97" height="164.5527" style="stroke: #777777; stroke-width: 1.0;" width="10" x="364" y="233.3516"/><rect fill="#FCD766" height="302.7949" style="stroke: #777777; stroke-width: 1.0;" width="10" x="599" y="267.6621"/><rect fill="#F19B97" height="164.5527" style="stroke: #777777; stroke-width: 1.0;" width="10" x="604" y="334.2832"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="840" y="65.7988"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="840" y="166.7305"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="840" y="267.6621"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="840" y="368.5938"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="840" y="469.5254"/><line style="stroke: #777777; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="124" x2="124" y1="34.4883" y2="588.457"/><line style="stroke: #777777; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="364" x2="364" y1="34.4883" y2="588.457"/><line style="stroke: #777777; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="604" x2="604" y1="34.4883" y2="588.457"/><line style="stroke: #777777; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="845" x2="845" y1="34.4883" y2="588.457"/><rect fill="#D98032" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="72" x="88" y="3"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="95" y="23.5352">ReaderA</text><rect fill="#D98032" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="72" x="88" y="587.457"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="95" y="607.9922">ReaderA</text><rect fill="#D98032" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="68" x="330" y="3"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="337" y="23.5352">WritterB</text><rect fill="#D98032" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="68" x="330" y="587.457"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="337" y="607.9922">WritterB</text><rect fill="#D98032" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="72" x="568" y="3"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="575" y="23.5352">ReaderC</text><rect fill="#D98032" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="72" x="568" y="587.457"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="575" y="607.9922">ReaderC</text><rect fill="#696773" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="58" x="816" y="3"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="823" y="23.5352">Kernel</text><rect fill="#696773" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="58" x="816" y="587.457"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="823" y="607.9922">Kernel</text><rect fill="#FCD766" height="302.7949" style="stroke: #777777; stroke-width: 1.0;" width="10" x="119" y="65.7988"/><rect fill="#FCD766" height="302.7949" style="stroke: #777777; stroke-width: 1.0;" width="10" x="359" y="166.7305"/><rect fill="#F19B97" height="164.5527" style="stroke: #777777; stroke-width: 1.0;" width="10" x="364" y="233.3516"/><rect fill="#FCD766" height="302.7949" style="stroke: #777777; stroke-width: 1.0;" width="10" x="599" y="267.6621"/><rect fill="#F19B97" height="164.5527" style="stroke: #777777; stroke-width: 1.0;" width="10" x="604" y="334.2832"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="840" y="65.7988"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="840" y="166.7305"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="840" y="267.6621"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="840" y="368.5938"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="840" y="469.5254"/><polygon fill="#666666" points="828,61.7988,838,65.7988,828,69.7988,832,65.7988" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="129" x2="834" y1="65.7988" y2="65.7988"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="136" y="61.0566">1.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="152" y="61.0566">attempts to get lock</text><polygon fill="#666666" points="140,91.1094,130,95.1094,140,99.1094,136,95.1094" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="134" x2="844" y1="95.1094" y2="95.1094"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="146" y="90.3672">2.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="162" y="90.3672">locked successful</text><line style="stroke: #666666; stroke-width: 1.0;" x1="129" x2="171" y1="124.4199" y2="124.4199"/><line style="stroke: #666666; stroke-width: 1.0;" x1="171" x2="171" y1="124.4199" y2="137.4199"/><line style="stroke: #666666; stroke-width: 1.0;" x1="130" x2="171" y1="137.4199" y2="137.4199"/><polygon fill="#666666" points="140,133.4199,130,137.4199,140,141.4199,136,137.4199" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="136" y="119.6777">3.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="152" y="119.6777">read data</text><polygon fill="#666666" points="828,162.7305,838,166.7305,828,170.7305,832,166.7305" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="369" x2="834" y1="166.7305" y2="166.7305"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="376" y="161.9883">4.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="392" y="161.9883">attempts to get lock</text><polygon fill="#666666" points="380,192.041,370,196.041,380,200.041,376,196.041" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="374" x2="844" y1="196.041" y2="196.041"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="386" y="191.2988">5.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="402" y="191.2988">failed to get lock</text><line style="stroke: #666666; stroke-width: 1.0;" x1="369" x2="416" y1="220.3516" y2="220.3516"/><line style="stroke: #666666; stroke-width: 1.0;" x1="416" x2="416" y1="220.3516" y2="233.3516"/><line style="stroke: #666666; stroke-width: 1.0;" x1="375" x2="416" y1="233.3516" y2="233.3516"/><polygon fill="#666666" points="385,229.3516,375,233.3516,385,237.3516,381,233.3516" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="381" y="215.6094">6.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="397" y="215.6094">sleep itself</text><polygon fill="#666666" points="828,263.6621,838,267.6621,828,271.6621,832,267.6621" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="609" x2="834" y1="267.6621" y2="267.6621"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="616" y="262.9199">7.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="632" y="262.9199">attempts to get lock</text><polygon fill="#666666" points="620,292.9727,610,296.9727,620,300.9727,616,296.9727" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="614" x2="844" y1="296.9727" y2="296.9727"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="626" y="292.2305">8.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="642" y="292.2305">failed to get lock</text><line style="stroke: #666666; stroke-width: 1.0;" x1="609" x2="656" y1="321.2832" y2="321.2832"/><line style="stroke: #666666; stroke-width: 1.0;" x1="656" x2="656" y1="321.2832" y2="334.2832"/><line style="stroke: #666666; stroke-width: 1.0;" x1="615" x2="656" y1="334.2832" y2="334.2832"/><polygon fill="#666666" points="625,330.2832,615,334.2832,625,338.2832,621,334.2832" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="621" y="316.541">9.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="637" y="316.541">sleep itself</text><polygon fill="#666666" points="828,364.5938,838,368.5938,828,372.5938,832,368.5938" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="124" x2="834" y1="368.5938" y2="368.5938"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="131" y="363.8516">10.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="155" y="363.8516">unlock</text><polygon fill="#666666" points="380,393.9043,370,397.9043,380,401.9043,376,397.9043" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="374" x2="844" y1="397.9043" y2="397.9043"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="386" y="393.1621">11.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="410" y="393.1621">wake up thread and get lock</text><line style="stroke: #666666; stroke-width: 1.0;" x1="369" x2="411" y1="427.2148" y2="427.2148"/><line style="stroke: #666666; stroke-width: 1.0;" x1="411" x2="411" y1="427.2148" y2="440.2148"/><line style="stroke: #666666; stroke-width: 1.0;" x1="370" x2="411" y1="440.2148" y2="440.2148"/><polygon fill="#666666" points="380,436.2148,370,440.2148,380,444.2148,376,440.2148" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="376" y="422.4727">12.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="400" y="422.4727">update data</text><polygon fill="#666666" points="828,465.5254,838,469.5254,828,473.5254,832,469.5254" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="364" x2="834" y1="469.5254" y2="469.5254"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="371" y="464.7832">13.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="395" y="464.7832">unlock</text><polygon fill="#666666" points="620,494.8359,610,498.8359,620,502.8359,616,498.8359" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="614" x2="844" y1="498.8359" y2="498.8359"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="626" y="494.0938">14.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="650" y="494.0938">wake up thread and get lock</text><line style="stroke: #666666; stroke-width: 1.0;" x1="609" x2="651" y1="528.1465" y2="528.1465"/><line style="stroke: #666666; stroke-width: 1.0;" x1="651" x2="651" y1="528.1465" y2="541.1465"/><line style="stroke: #666666; stroke-width: 1.0;" x1="610" x2="651" y1="541.1465" y2="541.1465"/><polygon fill="#666666" points="620,537.1465,610,541.1465,620,545.1465,616,541.1465" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="616" y="523.4043">15.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="640" y="523.4043">read data</text><polygon fill="#666666" points="833,566.457,843,570.457,833,574.457,837,570.457" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="604" x2="839" y1="570.457" y2="570.457"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="611" y="565.7148">16.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="635" y="565.7148">unlock</text><!--
@startuml reader_writer_first_lock

skinparam ParticipantPadding 80
skinparam BackgroundColor #EFF1F3
skinparam Shadowing false
skinparam sequence {
    ParticipantBorderColor #777777
    ParticipantFontColor #FFFFFF
    LifeLineBorderColor #777777
    ArrowColor #666666
    ArrowFontColor #333333
}

participant "ReaderA" as ra    #D98032
participant "WritterB" as wb    #D98032
participant "ReaderC" as rc     #D98032
participant "Kernel"  as kernel #696773

autonumber "0."

ra -> kernel : attempts to get lock
activate ra #FCD766
activate kernel #83828C

kernel -> ra : locked successful
deactivate kernel

ra -> ra : read data

wb -> kernel : attempts to get lock
activate wb #FCD766
activate kernel #83828C

kernel -> wb : failed to get lock
deactivate kernel

wb -> wb : sleep itself
activate wb #F19B97

rc -> kernel : attempts to get lock
activate rc #FCD766
activate kernel #83828C

kernel -> rc : failed to get lock
deactivate kernel

rc -> rc : sleep itself
activate rc #F19B97

ra -> kernel : unlock
deactivate ra
activate kernel #83828C

kernel -> wb : wake up thread and get lock
deactivate kernel
deactivate wb

wb -> wb : update data

wb -> kernel : unlock
deactivate wb
activate kernel #83828C

kernel -> rc : wake up thread and get lock
deactivate kernel
deactivate rc

rc -> rc : read data

rc -> kernel : unlock
deactivate rc

@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 CST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 14.0.2+12-46
Operating System: Mac OS X
OS Version: 10.15.6
Default Encoding: UTF-8
Language: zh
Country: TW
--></g></svg>