<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="427px" preserveAspectRatio="none" style="width:641px;height:427px;background:#EFF1F3;" version="1.1" viewBox="0 0 641 427" width="641px" zoomAndPan="magnify"><defs/><g><rect fill="#FCD766" height="201.8633" style="stroke: #777777; stroke-width: 1.0;" width="10" x="119.5" y="65.7988"/><rect fill="#FCD766" height="201.8633" style="stroke: #777777; stroke-width: 1.0;" width="10" x="361.5" y="166.7305"/><rect fill="#F19B97" height="63.6211" style="stroke: #777777; stroke-width: 1.0;" width="10" x="366.5" y="233.3516"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="596" y="65.7988"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="596" y="166.7305"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="596" y="267.6621"/><line style="stroke: #777777; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="124" x2="124" y1="34.4883" y2="386.5938"/><line style="stroke: #777777; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="366" x2="366" y1="34.4883" y2="386.5938"/><line style="stroke: #777777; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="601" x2="601" y1="34.4883" y2="386.5938"/><rect fill="#D98032" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="73" x="88" y="3"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="95" y="23.5352">ThreadA</text><rect fill="#D98032" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="73" x="88" y="385.5938"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="95" y="406.1289">ThreadA</text><rect fill="#D98032" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="71" x="331" y="3"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="338" y="23.5352">ThreadB</text><rect fill="#D98032" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="71" x="331" y="385.5938"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="338" y="406.1289">ThreadB</text><rect fill="#696773" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="58" x="572" y="3"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="579" y="23.5352">Kernel</text><rect fill="#696773" height="30.4883" style="stroke: #777777; stroke-width: 1.5;" width="58" x="572" y="385.5938"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="579" y="406.1289">Kernel</text><rect fill="#FCD766" height="201.8633" style="stroke: #777777; stroke-width: 1.0;" width="10" x="119.5" y="65.7988"/><rect fill="#FCD766" height="201.8633" style="stroke: #777777; stroke-width: 1.0;" width="10" x="361.5" y="166.7305"/><rect fill="#F19B97" height="63.6211" style="stroke: #777777; stroke-width: 1.0;" width="10" x="366.5" y="233.3516"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="596" y="65.7988"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="596" y="166.7305"/><rect fill="#83828C" height="29.3105" style="stroke: #777777; stroke-width: 1.0;" width="10" x="596" y="267.6621"/><polygon fill="#666666" points="584,61.7988,594,65.7988,584,69.7988,588,65.7988" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="129.5" x2="590" y1="65.7988" y2="65.7988"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="136.5" y="61.0566">1.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="152.5" y="61.0566">attempts to get lock</text><polygon fill="#666666" points="140.5,91.1094,130.5,95.1094,140.5,99.1094,136.5,95.1094" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="134.5" x2="600" y1="95.1094" y2="95.1094"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="146.5" y="90.3672">2.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="162.5" y="90.3672">locked successful</text><line style="stroke: #666666; stroke-width: 1.0;" x1="129.5" x2="171.5" y1="124.4199" y2="124.4199"/><line style="stroke: #666666; stroke-width: 1.0;" x1="171.5" x2="171.5" y1="124.4199" y2="137.4199"/><line style="stroke: #666666; stroke-width: 1.0;" x1="130.5" x2="171.5" y1="137.4199" y2="137.4199"/><polygon fill="#666666" points="140.5,133.4199,130.5,137.4199,140.5,141.4199,136.5,137.4199" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="136.5" y="119.6777">3.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="152.5" y="119.6777">do something</text><polygon fill="#666666" points="584,162.7305,594,166.7305,584,170.7305,588,166.7305" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="371.5" x2="590" y1="166.7305" y2="166.7305"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="378.5" y="161.9883">4.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="394.5" y="161.9883">attempts to get lock</text><polygon fill="#666666" points="382.5,192.041,372.5,196.041,382.5,200.041,378.5,196.041" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="376.5" x2="600" y1="196.041" y2="196.041"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="388.5" y="191.2988">5.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="404.5" y="191.2988">failed to get lock</text><line style="stroke: #666666; stroke-width: 1.0;" x1="371.5" x2="418.5" y1="220.3516" y2="220.3516"/><line style="stroke: #666666; stroke-width: 1.0;" x1="418.5" x2="418.5" y1="220.3516" y2="233.3516"/><line style="stroke: #666666; stroke-width: 1.0;" x1="377.5" x2="418.5" y1="233.3516" y2="233.3516"/><polygon fill="#666666" points="387.5,229.3516,377.5,233.3516,387.5,237.3516,383.5,233.3516" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="383.5" y="215.6094">6.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="399.5" y="215.6094">sleep itself</text><polygon fill="#666666" points="584,263.6621,594,267.6621,584,271.6621,588,267.6621" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="124.5" x2="590" y1="267.6621" y2="267.6621"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="131.5" y="262.9199">7.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="147.5" y="262.9199">unlock</text><polygon fill="#666666" points="382.5,292.9727,372.5,296.9727,382.5,300.9727,378.5,296.9727" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="376.5" x2="600" y1="296.9727" y2="296.9727"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="388.5" y="292.2305">8.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="404.5" y="292.2305">wake up thread and get lock</text><line style="stroke: #666666; stroke-width: 1.0;" x1="371.5" x2="413.5" y1="326.2832" y2="326.2832"/><line style="stroke: #666666; stroke-width: 1.0;" x1="413.5" x2="413.5" y1="326.2832" y2="339.2832"/><line style="stroke: #666666; stroke-width: 1.0;" x1="372.5" x2="413.5" y1="339.2832" y2="339.2832"/><polygon fill="#666666" points="382.5,335.2832,372.5,339.2832,382.5,343.2832,378.5,339.2832" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="378.5" y="321.541">9.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="394.5" y="321.541">do something</text><polygon fill="#666666" points="589,364.5938,599,368.5938,589,372.5938,593,368.5938" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.0;" x1="366.5" x2="595" y1="368.5938" y2="368.5938"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="373.5" y="363.8516">10.</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="397.5" y="363.8516">unlock</text><!--
@startuml mutex_lock

skinparam ParticipantPadding 80
skinparam BackgroundColor #EFF1F3
skinparam Shadowing false
skinparam sequence {
    ParticipantBorderColor #777777
    ParticipantFontColor #FFFFFF
    LifeLineBorderColor #777777
    ArrowColor #666666
    ArrowFontColor #333333
}

participant "ThreadA" as ta     #D98032
participant "ThreadB" as tb     #D98032
participant "Kernel"  as kernel #696773

autonumber "0."

ta -> kernel : attempts to get lock
activate ta #FCD766
activate kernel #83828C

kernel -> ta : locked successful
deactivate kernel

ta -> ta : do something

tb -> kernel : attempts to get lock
activate tb #FCD766
activate kernel #83828C

kernel -> tb : failed to get lock
deactivate kernel

tb -> tb : sleep itself
activate tb #F19B97

ta -> kernel : unlock
deactivate ta
activate kernel #83828C

kernel -> tb : wake up thread and get lock
deactivate kernel
deactivate tb

tb -> tb : do something


tb -> kernel : unlock
deactivate tb

@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 CST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 14.0.2+12-46
Operating System: Mac OS X
OS Version: 10.15.6
Default Encoding: UTF-8
Language: zh
Country: TW
--></g></svg>